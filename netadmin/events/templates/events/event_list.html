{% extends "base.html" %}
{% comment %}
Copyright (C) 2011 Adriano Monteiro Marques

Author: Piotrek Wasilewski <wasilewski.piotrek@gmail.com>

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}
{% load i18n %}
{% block title %}{% trans "events list" %}{% endblock %}

{% block content %}

{% if alerts %}
<h2>{% trans "Alerts" %} - {{ level_name|lower }}</h2>

<table>
	<thead>
		<tr><th>{% trans "Timestamp" %}</th><th>{% trans "Message" %}</th><th>{% trans "Event type" %}</th><th>{% trans "Host" %}</th></tr>
	</thead>
	<tbody>
	{% for event in alerts %}
		<tr>
			<td>{{ event.timestamp }}</td>
			<td class="notification-message">
				<a href="{% url event_detail event.pk %}">
				{% if event.short_message %}
					{{ event.short_message }}
				{% else %}
					{{ event.message|slice:":100" }}
				{% endif %}
				</a>
			</td>
			<td>{{ event.event_type }}</td>
			<td>
			{% if event.source_host %}
				<a href="{% url host_detail event.source_host.pk %}">{{ event.source_host.name }}</a>
			{% else %}
				Network-wide event
			{% endif %}
			</td>
		</tr>
	{% endfor %}
	</tbody>
</table>
{% endif %}

{% if events %}
<h2>{% trans "Events" %}</h2>

<form action="{% if adv_search %}{% url events_search %}{% endif %}" method="GET">
	{{ search_form.as_p }}
	<p><input type="submit" value="{% trans 'Search' %}" /> 
	<a href="{% url events_search %}">
	{% if adv_search %}
		{% trans "Clear all filters" %}
	{% else %}
		{% trans "Advanced search" %}
	{% endif %}
	</a>
	</p>
</form>

<table>
	<thead>
		<tr><th>{% trans "Timestamp" %}</th><th>{% trans "Message" %}</th><th>{% trans "Event type" %}</th><th>{% trans "Host" %}</th></tr>
	</thead>
	<tbody>
	{% for event in events %}
		<tr>
			<td>{{ event.timestamp }}</td>
			<td class="notification-message">
				<a href="{% url event_detail event.pk %}">
				{% if event.short_message %}
					{{ event.short_message }}
				{% else %}
					{{ event.message|slice:":100" }}
				{% endif %}
				</a>
			</td>
			<td>{{ event.event_type }}</td>
			<td><a href="{% url host_detail event.source_host.pk %}">{{ event.source_host.name }}</a></td>
		</tr>
	{% endfor %}
	</tbody>
</table>
{% endif %}

{% include "paginator.html" %}

{% endblock %}

{% block sidebar %}
<ul>
	<li><a href="{% url alerts_edit %}">{% trans "Alerts settings" %}</a></li>
</ul>
{% endblock %}