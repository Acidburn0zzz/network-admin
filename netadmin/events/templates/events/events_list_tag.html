{% comment %}
Copyright (C) 2011 Adriano Monteiro Marques

Author: Piotrek Wasilewski <wasilewski.piotrek@gmail.com>

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}
{% load i18n actions %}
{% if events %}
	{% if title %}
	<h3>{% trans title %}</h3>
	{% endif %}
	<table>
		<thead>
			<tr>
				<th>{% trans "Timestamp" %}</th>
				<th>{% trans "Message" %}</th>
				<th>{% trans "Type" %}</th>
				<th>{% trans "Protocol" %}</th>
				<th>{% trans "Host" %}</th>
			</tr>
		</thead>
		<tbody>
		{% for event in events %}
			<tr>
				<td>
					<a href="{% url events_date event.timestamp.year event.timestamp.month event.timestamp.day %}">
						{{ event.timestamp.date|action:"event_list_timestamp_date" }}
					</a>,
					{{ event.timestamp.time|action:"event_list_timestamp_time" }}
				</td>
				<td class="notification-message">
					<a href="{% url event_detail event.message_slug %}">
					{% if event.short_message %}
						{{ event.short_message|action:"event_list_short_message" }}
					{% else %}
						{{ event.message|slice:":100"|action:"event_list_message" }}
					{% endif %}
					</a>
				</td>
				<td>
					<a href="{% url eventtype_detail event.event_type.name_slug %}">
						{{ event.event_type|action:"event_list_event_type" }}
					</a>
				</td>
				<td>{{ event.protocol|action:"event_list_protocol" }}</td>
				<td>
					<a href="{% url host_detail event.source_host.pk %}">
						{{ event.source_host.name|action:"event_list_source_host_name" }}
					</a>
				</td>
			</tr>
		{% endfor %}
		</tbody>
	</table>
{% endif %}